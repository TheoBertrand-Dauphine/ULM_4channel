Traceback (most recent call last):
  File "train.py", line 95, in <module>
    main(args,42)
  File "train.py", line 61, in main
    samples = next(iter(valloader))
  File "/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1203, in _next_data
    return self._process_data(data)
  File "/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1229, in _process_data
    data.reraise()
  File "/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/torch/_utils.py", line 434, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/tbertrand/Bureau/ULM_4channel_pull/utils/dataset.py", line 145, in __getitem__
    sample = self.transform(sample)
  File "/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/torchvision/transforms/transforms.py", line 61, in __call__
    img = t(img)
  File "/home/tbertrand/Bureau/ULM_4channel_pull/utils/transforms.py", line 132, in __call__
    heat_map[0,landmarks[landmarks[:,1]**2+landmarks[:,0]**2 > 0,2].astype(int),landmarks[landmarks[:,1]**2+landmarks[:,0]**2 > 0,0].astype(int),landmarks[landmarks[:,1]**2+landmarks[:,0]**2 > 0,1].astype(int)] = 1.
IndexError: index 4778 is out of bounds for dimension 2 with size 256
[[1.54450977e+04 3.41333333e+03 0.00000000e+00]
 [9.81318359e+03 5.12000000e+03 0.00000000e+00]
 [1.79197266e+04 7.50933333e+03 0.00000000e+00]
 [1.57864258e+04 1.18613333e+04 0.00000000e+00]
 [1.74930664e+04 1.24586667e+04 0.00000000e+00]
 [1.47624414e+04 1.44213333e+04 0.00000000e+00]
 [1.10931641e+04 1.57866667e+04 0.00000000e+00]
 [1.03251758e+04 1.80053333e+04 0.00000000e+00]
 [1.86877148e+04 1.94560000e+04 0.00000000e+00]
 [1.27998047e+03 2.09920000e+04 0.00000000e+00]
 [7.85054688e+03 1.72373333e+04 1.00000000e+00]
 [7.76521484e+03 2.09920000e+04 1.00000000e+00]
 [1.03251758e+04 1.75786667e+04 1.00000000e+00]
 [9.38652344e+02 6.99733333e+03 1.00000000e+00]
 [5.80257812e+03 1.50186667e+04 1.00000000e+00]
 [6.31457031e+03 1.63840000e+04 1.00000000e+00]
 [2.09916797e+04 1.56160000e+04 1.00000000e+00]
 [1.93703711e+04 1.66400000e+04 1.00000000e+00]
 [1.85170508e+04 1.69813333e+04 1.00000000e+00]
 [1.68957422e+04 1.91146667e+04 1.00000000e+00]
 [1.82610547e+04 1.92000000e+04 1.00000000e+00]
 [2.06503516e+04 2.12480000e+04 1.00000000e+00]
 [3.92527344e+03 5.63200000e+03 1.00000000e+00]
 [1.76637305e+04 9.47200000e+03 1.00000000e+00]
 [1.70664062e+04 1.06666667e+04 1.00000000e+00]
 [6.48523438e+03 1.77493333e+04 2.00000000e+00]
 [1.85170508e+04 1.48480000e+04 2.00000000e+00]
 [1.72370703e+04 1.20320000e+04 2.00000000e+00]
 [7.76521484e+03 1.10933333e+04 2.00000000e+00]
 [1.88583789e+04 1.74080000e+04 2.00000000e+00]
 [1.84317188e+04 1.65546667e+04 2.00000000e+00]
 [1.76637305e+04 1.67253333e+04 2.00000000e+00]
 [1.70664062e+04 1.80906667e+04 2.00000000e+00]
 [1.72370703e+04 7.42400000e+03 2.00000000e+00]
 [1.56157617e+04 3.92533333e+03 2.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]]
[[1.27144727e+04 0.00000000e+00 0.00000000e+00]
 [1.39091211e+04 4.77866667e+03 0.00000000e+00]
 [1.02398438e+03 5.12000000e+03 0.00000000e+00]
 [1.70664062e+03 5.29066667e+03 0.00000000e+00]
 [1.69810742e+04 6.65600000e+03 0.00000000e+00]
 [2.21863281e+03 6.74133333e+03 0.00000000e+00]
 [6.82656250e+02 7.59466667e+03 0.00000000e+00]
 [2.13330078e+04 8.27733333e+03 0.00000000e+00]
 [2.13330078e+03 9.55733333e+03 0.00000000e+00]
 [2.98662109e+03 1.67253333e+04 0.00000000e+00]
 [5.03458984e+03 1.78346667e+04 0.00000000e+00]
 [6.82656250e+02 1.80906667e+04 0.00000000e+00]
 [2.11623438e+04 1.94560000e+04 0.00000000e+00]
 [1.02398438e+03 2.09066667e+04 0.00000000e+00]
 [3.32794922e+03 2.15040000e+04 0.00000000e+00]
 [4.26660156e+03 1.16053333e+04 1.00000000e+00]
 [5.11992188e+03 1.23733333e+04 1.00000000e+00]
 [6.39990234e+03 1.31413333e+04 1.00000000e+00]
 [9.30119141e+03 1.53600000e+04 1.00000000e+00]
 [1.34824609e+04 1.74933333e+04 1.00000000e+00]
 [1.72370703e+04 2.16746667e+04 1.00000000e+00]
 [9.21585938e+03 1.28000000e+04 1.00000000e+00]
 [1.19464844e+03 7.85066667e+03 1.00000000e+00]
 [1.42504492e+04 1.66400000e+04 1.00000000e+00]
 [1.89437109e+04 1.74080000e+04 1.00000000e+00]
 [1.19464844e+03 4.52266667e+03 1.00000000e+00]
 [2.47462891e+03 4.09600000e+03 1.00000000e+00]
 [1.74930664e+04 5.54666667e+03 1.00000000e+00]
 [1.39091211e+04 1.10933333e+03 1.00000000e+00]
 [1.71517383e+04 2.56000000e+02 1.00000000e+00]
 [1.24584766e+04 2.98666667e+03 1.00000000e+00]
 [6.91189453e+03 5.97333333e+03 1.00000000e+00]
 [1.62130859e+04 8.53333333e+01 1.00000000e+00]
 [2.30396484e+03 3.75466667e+03 2.00000000e+00]
 [9.13052734e+03 1.42506667e+04 2.00000000e+00]
 [1.14344922e+04 9.38666667e+03 2.00000000e+00]
 [1.45064453e+04 1.78346667e+04 2.00000000e+00]
 [1.91143750e+04 7.16800000e+03 2.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00]]