GPU available: True, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py:1584: UserWarning: GPU available but not used. Set the gpus flag in your trainer `Trainer(gpus=1)` or script `--gpus=1`.
  rank_zero_warn(
   | Name       | Type            | Params
------------------------------------------------
0  | encoder1   | Sequential      | 2.5 K
1  | pool1      | MaxPool2d       | 0
2  | encoder2   | Sequential      | 14.0 K
3  | pool2      | MaxPool2d       | 0
4  | encoder3   | Sequential      | 55.6 K
5  | pool3      | MaxPool2d       | 0
6  | encoder4   | Sequential      | 221 K
7  | pool4      | MaxPool2d       | 0
8  | bottleneck | Sequential      | 885 K
9  | upconv4    | ConvTranspose2d | 131 K
10 | decoder4   | Sequential      | 442 K
11 | upconv3    | ConvTranspose2d | 32.8 K
12 | decoder3   | Sequential      | 110 K
13 | upconv2    | ConvTranspose2d | 8.2 K
14 | decoder2   | Sequential      | 27.8 K
15 | upconv1    | ConvTranspose2d | 2.1 K
16 | decoder1   | Sequential      | 7.0 K
17 | conv       | Conv2d          | 51
------------------------------------------------
1.9 M     Trainable params
0         Non-trainable params
1.9 M     Total params
7.769     Total estimated model params size (MB)
/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:631: UserWarning: Checkpoint directory /home/tbertrand/Bureau/ULM_4channel_pull/None/version_None/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:226: UserWarning: You called `self.log('F1 score', ...)` in your `validation_step` but the value needs to be floating point. Converting it to torch.float32.
  warning_cache.warn(

Epoch 0:  24%|██████████████████████████████████▌                                                                                                              | 10/42 [00:01<00:03,  8.62it/s, loss=0.201]
/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:428: UserWarning: The number of training samples (40) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

Epoch 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:04<00:00,  8.98it/s, loss=0.152]
Validating: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.84it/s]
/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/pytorch_lightning/loggers/wandb.py:341: UserWarning: There is a wandb run already in progress and newly created instances of `WandbLogger` will reuse this run. If this is not desired, call `wandb.finish()` before instantiating `WandbLogger`.




Epoch 2:  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 40/42 [00:03<00:00, 10.04it/s, loss=0.0417, v_num=d9jm]


Epoch 3:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 40/42 [00:03<00:00, 10.09it/s, loss=0.025, v_num=d9jm]


Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:04<00:00,  8.77it/s, loss=0.017, v_num=d9jm]


Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.36it/s, loss=0.0125, v_num=d9jm]


Epoch 6: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.87it/s, loss=0.00766, v_num=d9jm]


Epoch 7:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.49it/s, loss=0.00627, v_num=d9jm]


Epoch 8:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.66it/s, loss=0.00505, v_num=d9jm]


Epoch 9:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.80it/s, loss=0.00467, v_num=d9jm]


Epoch 10:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.39it/s, loss=0.00379, v_num=d9jm]


Epoch 11:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.78it/s, loss=0.00376, v_num=d9jm]


Epoch 12:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.68it/s, loss=0.00276, v_num=d9jm]


Epoch 13:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.57it/s, loss=0.00304, v_num=d9jm]


Epoch 14:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.90it/s, loss=0.00212, v_num=d9jm]


Epoch 15:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.97it/s, loss=0.00324, v_num=d9jm]


Epoch 16:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.77it/s, loss=0.00249, v_num=d9jm]


Epoch 17:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:03<00:00, 10.00it/s, loss=0.00269, v_num=d9jm]


Epoch 18:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.58it/s, loss=0.0018, v_num=d9jm]


Epoch 19:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.71it/s, loss=0.00183, v_num=d9jm]


Epoch 20:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.67it/s, loss=0.00226, v_num=d9jm]


Epoch 21: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.27it/s, loss=0.00165, v_num=d9jm]


Epoch 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:04<00:00,  8.44it/s, loss=0.0017, v_num=d9jm]


Epoch 23: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.29it/s, loss=0.00201, v_num=d9jm]


Epoch 24: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:04<00:00,  8.43it/s, loss=0.00165, v_num=d9jm]


Epoch 25: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.13it/s, loss=0.00154, v_num=d9jm]


Epoch 26: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.36it/s, loss=0.00175, v_num=d9jm]


Epoch 27:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.70it/s, loss=0.00153, v_num=d9jm]


Epoch 28:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.50it/s, loss=0.00145, v_num=d9jm]


Epoch 29:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.42it/s, loss=0.00155, v_num=d9jm]


Epoch 30:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.55it/s, loss=0.00157, v_num=d9jm]


Epoch 31:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.55it/s, loss=0.00147, v_num=d9jm]


Epoch 32:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.65it/s, loss=0.0014, v_num=d9jm]


Epoch 33:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.44it/s, loss=0.00147, v_num=d9jm]


Epoch 34:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.43it/s, loss=0.00162, v_num=d9jm]


Epoch 35:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.41it/s, loss=0.00149, v_num=d9jm]


Epoch 36:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.61it/s, loss=0.00124, v_num=d9jm]


Epoch 37:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.57it/s, loss=0.00134, v_num=d9jm]


Epoch 38:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.42it/s, loss=0.00141, v_num=d9jm]


Epoch 39:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.50it/s, loss=0.00125, v_num=d9jm]


Epoch 40:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.57it/s, loss=0.00135, v_num=d9jm]



Epoch 41: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.79it/s, loss=0.00127, v_num=d9jm]


Epoch 42: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.39it/s, loss=0.00131, v_num=d9jm]


Epoch 43: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.09it/s, loss=0.00124, v_num=d9jm]


Epoch 44: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.35it/s, loss=0.0013, v_num=d9jm]


Epoch 45: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.13it/s, loss=0.00121, v_num=d9jm]


Epoch 46: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.14it/s, loss=0.00126, v_num=d9jm]


Epoch 47: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.05it/s, loss=0.00126, v_num=d9jm]


Epoch 48: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.97it/s, loss=0.00128, v_num=d9jm]


Epoch 49:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.35it/s, loss=0.00114, v_num=d9jm]


Epoch 50:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.59it/s, loss=0.00126, v_num=d9jm]


Epoch 51:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.49it/s, loss=0.00122, v_num=d9jm]


Epoch 52:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.58it/s, loss=0.00118, v_num=d9jm]


Epoch 53:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.47it/s, loss=0.00117, v_num=d9jm]


Epoch 54:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.59it/s, loss=0.00129, v_num=d9jm]


Epoch 55:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.70it/s, loss=0.00119, v_num=d9jm]


Epoch 56:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.49it/s, loss=0.00131, v_num=d9jm]


Epoch 57:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.57it/s, loss=0.0011, v_num=d9jm]


Epoch 58:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.53it/s, loss=0.00101, v_num=d9jm]


Epoch 59:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.77it/s, loss=0.00103, v_num=d9jm]


Epoch 60:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.50it/s, loss=0.00121, v_num=d9jm]


Epoch 61:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.74it/s, loss=0.00109, v_num=d9jm]


Epoch 62:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.63it/s, loss=0.00098, v_num=d9jm]


Epoch 63:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  8.91it/s, loss=0.000989, v_num=d9jm]



Epoch 64: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.88it/s, loss=0.00119, v_num=d9jm]


Epoch 65: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.20it/s, loss=0.0011, v_num=d9jm]


Epoch 66: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.37it/s, loss=0.00105, v_num=d9jm]


Epoch 67: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.98it/s, loss=0.00122, v_num=d9jm]


Epoch 68:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.37it/s, loss=0.00104, v_num=d9jm]


Epoch 69:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.43it/s, loss=0.000991, v_num=d9jm]


Epoch 70:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.20it/s, loss=0.000916, v_num=d9jm]


Epoch 71:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.34it/s, loss=0.000987, v_num=d9jm]


Epoch 72:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.33it/s, loss=0.000883, v_num=d9jm]






Epoch 74: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.13it/s, loss=0.00118, v_num=d9jm]


Epoch 75: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.06it/s, loss=0.00105, v_num=d9jm]


Epoch 76: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.95it/s, loss=0.00111, v_num=d9jm]


Epoch 77: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.16it/s, loss=0.000973, v_num=d9jm]


Epoch 78: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.03it/s, loss=0.000782, v_num=d9jm]


Epoch 79: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.98it/s, loss=0.000937, v_num=d9jm]


Epoch 80:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.27it/s, loss=0.000862, v_num=d9jm]


Epoch 81:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.21it/s, loss=0.000859, v_num=d9jm]


Epoch 82:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.38it/s, loss=0.000913, v_num=d9jm]


Epoch 83:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.66it/s, loss=0.000895, v_num=d9jm]









Epoch 86: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.92it/s, loss=0.000817, v_num=d9jm]





Epoch 88: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.20it/s, loss=0.000911, v_num=d9jm]


Epoch 89: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.22it/s, loss=0.000825, v_num=d9jm]














Epoch 94: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.83it/s, loss=0.000817, v_num=d9jm]


Epoch 95:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.10it/s, loss=0.000885, v_num=d9jm]


Epoch 96: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:04<00:00,  8.46it/s, loss=0.000825, v_num=d9jm]


Epoch 97:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.31it/s, loss=0.000741, v_num=d9jm]


Epoch 98:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.53it/s, loss=0.000835, v_num=d9jm]


Epoch 99:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.63it/s, loss=0.000687, v_num=d9jm]

Validating:   0%|                                                                                                                                                                    | 0/2 [00:00<?, ?it/s]