
Validation sanity check:  50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:00<00:00,  1.11it/s]
GPU available: True, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py:1584: UserWarning: GPU available but not used. Set the gpus flag in your trainer `Trainer(gpus=1)` or script `--gpus=1`.
  rank_zero_warn(
   | Name       | Type            | Params
------------------------------------------------
0  | encoder1   | Sequential      | 2.5 K
1  | pool1      | MaxPool2d       | 0
2  | encoder2   | Sequential      | 14.0 K
3  | pool2      | MaxPool2d       | 0
4  | encoder3   | Sequential      | 55.6 K
5  | pool3      | MaxPool2d       | 0
6  | encoder4   | Sequential      | 221 K
7  | pool4      | MaxPool2d       | 0
8  | bottleneck | Sequential      | 885 K
9  | upconv4    | ConvTranspose2d | 131 K
10 | decoder4   | Sequential      | 442 K
11 | upconv3    | ConvTranspose2d | 32.8 K
12 | decoder3   | Sequential      | 110 K
13 | upconv2    | ConvTranspose2d | 8.2 K
14 | decoder2   | Sequential      | 27.8 K
15 | upconv1    | ConvTranspose2d | 2.1 K
16 | decoder1   | Sequential      | 7.0 K
17 | conv       | Conv2d          | 51
------------------------------------------------
1.9 M     Trainable params
0         Non-trainable params
1.9 M     Total params
7.769     Total estimated model params size (MB)
/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:631: UserWarning: Checkpoint directory /home/tbertrand/Bureau/ULM_4channel_pull/None/version_None/checkpoints exists and is not empty.

Epoch 0:  21%|███████████████████████████████                                                                                                                  | 9/42 [00:01<00:04,  8.21it/s, loss=0.0988]
/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:226: UserWarning: You called `self.log('F1 score', ...)` in your `validation_step` but the value needs to be floating point. Converting it to torch.float32.
  warning_cache.warn(
/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:428: UserWarning: The number of training samples (40) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

Epoch 0:  98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 41/42 [00:04<00:00,  9.79it/s, loss=0.0532]

Validating:  50%|██████████████████████████████████████████████████████████████████████████████                                                                              | 1/2 [00:00<00:00,  1.06it/s]
/home/tbertrand/Bureau/ULM_4channel_pull/lib/python3.8/site-packages/pytorch_lightning/loggers/wandb.py:341: UserWarning: There is a wandb run already in progress and newly created instances of `WandbLogger` will reuse this run. If this is not desired, call `wandb.finish()` before instantiating `WandbLogger`.

Epoch 1:  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 40/42 [00:04<00:00,  9.57it/s, loss=0.0213, v_num=mdsk]


Epoch 2:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.50it/s, loss=0.00961, v_num=mdsk]


Epoch 3:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.44it/s, loss=0.00566, v_num=mdsk]


Epoch 4:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.34it/s, loss=0.00392, v_num=mdsk]


Epoch 5:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.52it/s, loss=0.00324, v_num=mdsk]


Epoch 6:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.45it/s, loss=0.00282, v_num=mdsk]


Epoch 7:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.10it/s, loss=0.00262, v_num=mdsk]








Epoch 10:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.79it/s, loss=0.00196, v_num=mdsk]


Epoch 11:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.65it/s, loss=0.00179, v_num=mdsk]


Epoch 12:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.67it/s, loss=0.0017, v_num=mdsk]


Epoch 13:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.72it/s, loss=0.00172, v_num=mdsk]



Epoch 14: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.05it/s, loss=0.00167, v_num=mdsk]


Epoch 15: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:04<00:00,  8.49it/s, loss=0.00151, v_num=mdsk]


Epoch 16: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.97it/s, loss=0.00148, v_num=mdsk]


Epoch 17: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.86it/s, loss=0.00158, v_num=mdsk]


Epoch 18: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.16it/s, loss=0.00144, v_num=mdsk]


Epoch 19: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.81it/s, loss=0.00136, v_num=mdsk]


Epoch 20:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  8.77it/s, loss=0.00148, v_num=mdsk]


Epoch 21:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.13it/s, loss=0.00132, v_num=mdsk]


Epoch 22:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.21it/s, loss=0.00123, v_num=mdsk]


Epoch 23:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.34it/s, loss=0.00146, v_num=mdsk]












Epoch 27: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.04it/s, loss=0.00113, v_num=mdsk]


Epoch 28: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.19it/s, loss=0.00119, v_num=mdsk]


Epoch 29: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.95it/s, loss=0.00109, v_num=mdsk]


Epoch 30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.25it/s, loss=0.00104, v_num=mdsk]


Epoch 31: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.28it/s, loss=0.00121, v_num=mdsk]


Epoch 32: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.02it/s, loss=0.0012, v_num=mdsk]


Epoch 33:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  8.81it/s, loss=0.00121, v_num=mdsk]


Epoch 34:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.08it/s, loss=0.00115, v_num=mdsk]


Epoch 35:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.39it/s, loss=0.00104, v_num=mdsk]


Epoch 36:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.58it/s, loss=0.0011, v_num=mdsk]









Epoch 39: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.95it/s, loss=0.000932, v_num=mdsk]


Epoch 40: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.19it/s, loss=0.00106, v_num=mdsk]


Epoch 41: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.07it/s, loss=0.00109, v_num=mdsk]


Epoch 42: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.16it/s, loss=0.00102, v_num=mdsk]


Epoch 43: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.99it/s, loss=0.00126, v_num=mdsk]


Epoch 44:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.46it/s, loss=0.00105, v_num=mdsk]


Epoch 45:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.70it/s, loss=0.00107, v_num=mdsk]


Epoch 46:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.39it/s, loss=0.00101, v_num=mdsk]


Epoch 47:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.08it/s, loss=0.00101, v_num=mdsk]


Epoch 48:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.60it/s, loss=0.000953, v_num=mdsk]


Epoch 49:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.62it/s, loss=0.000986, v_num=mdsk]


Epoch 50:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.29it/s, loss=0.000932, v_num=mdsk]


Epoch 51:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.52it/s, loss=0.00089, v_num=mdsk]


Epoch 52:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.36it/s, loss=0.000882, v_num=mdsk]


Epoch 53:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.09it/s, loss=0.000873, v_num=mdsk]



Epoch 54: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.83it/s, loss=0.00101, v_num=mdsk]


Epoch 55: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.17it/s, loss=0.000989, v_num=mdsk]


Epoch 56: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.23it/s, loss=0.000818, v_num=mdsk]


Epoch 57: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.99it/s, loss=0.00103, v_num=mdsk]


Epoch 58: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.22it/s, loss=0.000875, v_num=mdsk]


Epoch 59: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.34it/s, loss=0.000875, v_num=mdsk]


Epoch 60: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.20it/s, loss=0.00101, v_num=mdsk]


Epoch 61: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.31it/s, loss=0.000895, v_num=mdsk]


Epoch 62:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  8.86it/s, loss=0.000835, v_num=mdsk]


Epoch 63:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.57it/s, loss=0.000851, v_num=mdsk]


Epoch 64:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.23it/s, loss=0.000823, v_num=mdsk]






Epoch 66: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.03it/s, loss=0.000893, v_num=mdsk]


Epoch 67: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.30it/s, loss=0.000791, v_num=mdsk]


Epoch 68: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.20it/s, loss=0.000799, v_num=mdsk]


Epoch 69: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.30it/s, loss=0.000697, v_num=mdsk]


Epoch 70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.14it/s, loss=0.000755, v_num=mdsk]


Epoch 71: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.20it/s, loss=0.000786, v_num=mdsk]


Epoch 72: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.33it/s, loss=0.000712, v_num=mdsk]


Epoch 73: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.39it/s, loss=0.000741, v_num=mdsk]


Epoch 74: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.34it/s, loss=0.000727, v_num=mdsk]


Epoch 75: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.29it/s, loss=0.000729, v_num=mdsk]


Epoch 76: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:04<00:00,  8.42it/s, loss=0.000752, v_num=mdsk]


Epoch 77: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:04<00:00,  8.40it/s, loss=0.000687, v_num=mdsk]


Epoch 78: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.06it/s, loss=0.000663, v_num=mdsk]


Epoch 79: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.71it/s, loss=0.000639, v_num=mdsk]


Epoch 80: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.95it/s, loss=0.000678, v_num=mdsk]


Epoch 81:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.50it/s, loss=0.000544, v_num=mdsk]


Epoch 82:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.50it/s, loss=0.000599, v_num=mdsk]


Epoch 83:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.56it/s, loss=0.000591, v_num=mdsk]


Epoch 84:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.52it/s, loss=0.000434, v_num=mdsk]


Epoch 85:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.22it/s, loss=0.00045, v_num=mdsk]


Epoch 86:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.57it/s, loss=0.000497, v_num=mdsk]


Epoch 87:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.45it/s, loss=0.000413, v_num=mdsk]


Epoch 88:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.66it/s, loss=0.000367, v_num=mdsk]


Epoch 89:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.63it/s, loss=0.000321, v_num=mdsk]


Epoch 90:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.62it/s, loss=0.000276, v_num=mdsk]


Epoch 91:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.74it/s, loss=0.000246, v_num=mdsk]


Epoch 92:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 40/42 [00:04<00:00,  9.22it/s, loss=0.000246, v_num=mdsk]






Epoch 94: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.89it/s, loss=0.000208, v_num=mdsk]


Epoch 95: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.19it/s, loss=0.000197, v_num=mdsk]


Epoch 96: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.17it/s, loss=0.000186, v_num=mdsk]


Epoch 97: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.25it/s, loss=0.000141, v_num=mdsk]


Epoch 98: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.07it/s, loss=0.00018, v_num=mdsk]


Epoch 99: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  8.18it/s, loss=0.000165, v_num=mdsk]

Validating:  50%|██████████████████████████████████████████████████████████████████████████████                                                                              | 1/2 [00:00<00:00,  1.15it/s]